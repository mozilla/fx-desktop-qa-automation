---
transforms:
  - fx_desktop_qa_automation_taskgraph.transforms.lint:transforms

task-defaults:
  worker-type: t-linux-wayland-vm
  worker:
    max-run-time: 1800

tasks:
  linux:
    run:
      using: run-task
      cwd: "{checkout}"
      command: |-
        mkdir /builds && \
        adduser --home /builds/worker --shell /bin/bash --disabled-password --gecos "" worker && \
        mkdir /builds/worker/artifacts && \
        chown worker:worker /builds/worker/artifacts && \
        chown worker:worker /root && \
        chmod u+w /root
        apt update -y && apt upgrade -y
        apt install -y git python3-pip python-is-python3 curl jq wget bzip2i libxt6
        apt install -y libxtst6 libgtk-3-0 libx11-xcb-dev libdbus-glib-1-2 libpci-de
        rm -rf /var/lib/apt/lists/
        python -m pip install --no-cache --upgrade pip setuptools pytest selenium pipenv ruff
        export PATH=/root/.local/bin:/root/.local/bin:/builds/worker/.local/bin:$PATH
        export HOME=/builds/worker
